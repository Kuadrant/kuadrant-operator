version: "prometheus/v1"
service: "kuadrant"
labels:
  owner: "kuadrant-org"
slos:
  - name: "requests-latency"
    objective: 99.95
    description: "Multi window multi burn rate SLO based on latency for HTTP request responses."
    sli:
      events:
        error_query: sum(rate(istio_request_duration_milliseconds_bucket{le="250", job="ingress-metrics-proxy", response_code="200" }[{{.window}}]) )by (request_host) 
        total_query: sum(rate(istio_request_duration_milliseconds_count{job="ingress-metrics-proxy",response_code="200"}[{{.window}}]))by (request_host)
    alerting:
      name: KuadrantlatencyHighErrorRate
      labels:
        category: "latency"
      annotations:
        # Overwrite default Sloth SLO alert summmary on ticket and page alerts.
        summary: "High latency on HTTPRoute requests responses {{$labels.request_host}}"
      page_alert:
        labels:
          severity: critical
      ticket_alert:
        labels:
          severity: warning